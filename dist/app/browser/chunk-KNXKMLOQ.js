import{L as d,Lb as u,ha as c}from"./chunk-UMI3KQKL.js";var g=class l{recursosSignal=c([]);testimoniosSignal=c([]);institucionesSignal=c([]);recursos=this.recursosSignal.asReadonly();testimonios=this.testimoniosSignal.asReadonly();instituciones=this.institucionesSignal.asReadonly();totalRecursos=u(()=>this.recursosSignal().length);totalTestimonios=u(()=>this.testimoniosSignal().length);totalInstituciones=u(()=>this.institucionesSignal().length);libros=u(()=>this.recursosSignal().filter(t=>t.subtipo==="libro"));peliculasSeries=u(()=>this.recursosSignal().filter(t=>t.subtipo==="pelicula_serie"));documentales=u(()=>this.recursosSignal().filter(t=>t.subtipo==="documental"));loadRecursos(t){this.recursosSignal.set(t.filter(e=>e.activo))}loadTestimonios(t){this.testimoniosSignal.set(t.filter(e=>e.activo))}loadInstituciones(t){this.institucionesSignal.set(t.filter(e=>e.activo))}filterRecursos(t,e="es"){let o=this.recursosSignal();if(t.subtipo&&(o=o.filter(i=>i.subtipo===t.subtipo)),t.autor){let i=t.autor.toLowerCase();o=o.filter(s=>s.autor?.toLowerCase().includes(i))}if(t.anio&&(o=o.filter(i=>i.anio===t.anio)),t.anioDesde&&(o=o.filter(i=>!i.anio||i.anio>=t.anioDesde)),t.anioHasta&&(o=o.filter(i=>!i.anio||i.anio<=t.anioHasta)),t.hashtags&&t.hashtags.length>0&&(o=o.filter(i=>t.hashtags.some(s=>i.hashtags.some(n=>n.id===s||n.slug===s)))),t.busqueda){let i=t.busqueda.toLowerCase();o=o.filter(s=>{let n=s.titulo[e]||s.titulo.es||"",a=s.descripcion[e]||s.descripcion.es||"",r=s.descripcion_lectura_facil[e]||s.descripcion_lectura_facil.es||"";return n.toLowerCase().includes(i)||a.toLowerCase().includes(i)||r.toLowerCase().includes(i)||s.autor&&s.autor.toLowerCase().includes(i)})}return o}filterInstituciones(t,e="es"){let o=this.institucionesSignal();if(t.ambito&&(o=o.filter(i=>i.ambito===t.ambito)),t.hashtags&&t.hashtags.length>0&&(o=o.filter(i=>t.hashtags.some(s=>i.hashtags.some(n=>n.id===s||n.slug===s)))),t.busqueda){let i=t.busqueda.toLowerCase();o=o.filter(s=>{let n=s.titulo[e]||s.titulo.es||"",a=s.descripcion[e]||s.descripcion.es||"";return n.toLowerCase().includes(i)||a.toLowerCase().includes(i)||s.telefono&&s.telefono.includes(t.busqueda)||s.email&&s.email.toLowerCase().includes(i)})}return o}getRecursoBySlug(t){return this.recursosSignal().find(e=>e.slug===t)}getTestimonioBySlug(t){return this.testimoniosSignal().find(e=>e.slug===t)}getInstitucionBySlug(t){return this.institucionesSignal().find(e=>e.slug===t)}getInstitucionesByIds(t){return this.institucionesSignal().filter(e=>t.includes(e.id))}getRecursosStats(){let t=new Map;return this.recursosSignal().forEach(e=>{t.set(e.subtipo,(t.get(e.subtipo)||0)+1)}),Array.from(t.entries()).map(([e,o])=>({subtipo:e,count:o}))}getAutores(){let t=new Set;return this.recursosSignal().filter(e=>e.subtipo==="libro"&&e.autor).forEach(e=>t.add(e.autor)),Array.from(t).sort()}getAnios(){let t=new Set;return this.recursosSignal().filter(e=>e.anio).forEach(e=>t.add(e.anio)),Array.from(t).sort((e,o)=>o-e)}sortRecursos(t,e,o="asc",i="es"){let s=[...t];return s.sort((n,a)=>{let r=0;switch(e){case"titulo":let m=n.titulo[i]||n.titulo.es||"",p=a.titulo[i]||a.titulo.es||"";r=m.localeCompare(p);break;case"anio":r=(n.anio||0)-(a.anio||0);break;case"autor":let f=n.autor||"",b=a.autor||"";r=f.localeCompare(b);break}return o==="asc"?r:-r}),s}clear(){this.recursosSignal.set([]),this.testimoniosSignal.set([]),this.institucionesSignal.set([])}static \u0275fac=function(e){return new(e||l)};static \u0275prov=d({token:l,factory:l.\u0275fac,providedIn:"root"})};export{g as a};
